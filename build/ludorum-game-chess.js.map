{"version":3,"sources":["../src/__prologue__.js","../src/Chess.js","../src/__epilogue__.js"],"names":[],"mappings":"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","file":"ludorum-game-chess.js","sourcesContent":["/** Package wrapper and layout.\n*/\nfunction __init__(base, Sermat, ludorum) { \"use strict\";\n// Import synonyms. ////////////////////////////////////////////////////////////////////////////////\n\tvar declare = base.declare,\n\t\tobj = base.obj,\n\t\tcopy = base.copy,\n\t\traise = base.raise,\n\t\traiseIf = base.raiseIf,\n\t\tIterable = base.Iterable,\n\t\titerable = base.iterable,\n\t\tGame = ludorum.Game,\n\t\tCheckerboard = ludorum.utils.Checkerboard,\n\t\tCheckerboardFromString = ludorum.utils.CheckerboardFromString,\n\t\tUserInterface = ludorum.players.UserInterface;\n\n// Library layout. /////////////////////////////////////////////////////////////////////////////////\n\tvar exports = {\n\t\t__package__: 'ludorum-game-connect4',\n\t\t__name__: 'ludorum_game_connect4',\n\t\t__init__: __init__,\n\t\t__dependencies__: [base, Sermat, ludorum],\n\t\t__SERMAT__: { include: [base, ludorum] }\n\t};\n","/** # Chess\n\nImplementation of [Chess](http://www.fide.com/component/handbook/?id=124&view=article) for Ludorum.\n*/\n\n/** `Piece` is the base class for all pieces in the game. Pieces' classes help to calculate moves,\nand the effects these moves have on the board.\n*/\nvar Piece = declare({\n\tconstructor: function Piece(player, position) {\n\t\tthis.player = player;\n\t\tthis.position = position;\n\t},\n\n\tmoves: base.objects.unimplemented('Piece', 'moves(game, board)'),\n\n\tcanMove: base.objects.unimplemented('Piece', 'canMove(game, board, position)'),\n\n\tmoveTo: function moveTo(position) {\n\t\treturn new this.constructor(this.player, position);\n\t},\n\n\tnext: function (game, board, move) {\n\t\treturn board.clone()\n\t\t\t.__place__(move[1])\n\t\t\t.__place__(move[2], this.moveTo(move[2]));\n\t}\n});\n\nvar Chess = exports.Chess = declare(Game, {\n\tname: 'Chess',\n\n\t/** The game is played by two players: White and Black. White moves first.\n\t*/\n\tplayers: [\"White\", \"Black\"],\n\n\t/** The constructor takes the `activePlayer` (`\"White\"` by default), and the `board` as an\n\tinstance of `CheckerboardFromPieces` (with the initial setup by default).\n\t*/\n\tconstructor: function Chess(params){\n\t\tparams = params || {};\n\t\tGame.call(this, params.activePlayer || this.players[0]);\n\t\tthis.board = !params.board ? this.initialBoard\n\t\t\t: typeof params.board === 'string' ? Chess.boardFromFEN(params.board)\n\t\t\t: params.board;\n\t\tthis.castling = params.castling || \"KQkq\";\n\t\tthis.enPassant = params.enPassant;\n\t\tthis.halfMoves = params.halfMoves |0;\n\t\tthis.fullMoves = Math.max(params.fullMoves |0, 1);\n\n\t\t// Classify pieces by player and kind.\n\t\tvar game = this;\n\t\tthis.pieces = iterable(this.players).map(function (player) {\n\t\t\treturn [player, iterable(game.kinds).mapApply(function (kindName, kindConstructor) {\n\t\t\t\treturn [kindName, []];\n\t\t\t}).toObject()];\n\t\t}).toObject();\n\t\titerable(this.board.pieces).forEachApply(function (_, piece) {\n\t\t\tgame.pieces[piece.player][piece.name].push(piece);\n\t\t});\n\t},\n\n\n\t/** The piece `kinds` of Chess are: Pawn, Knight, Bishop, Rook, Queen and King.\n\t*/\n\t'dual kinds': {\n\t\tPawn: declare(Piece, {\n\t\t\tname: 'Pawn',\n\n\t\t\tmoves: function moves(game, board) { // TODO En passant captures.\n\t\t\t\tvar piece = this,\n\t\t\t\t\tdirection = (this.player === game.players[0]) ? -1 : +1,\n\t\t\t\t\tr = [],\n\t\t\t\t\tp = [this.position[0] + direction, this.position[1]];\n\t\t\t\tif (!board.square(p)) { // move forward\n\t\t\t\t\tr.push(p);\n\t\t\t\t}\n\t\t\t\t[[direction,-1], [direction,+1]].map(function (d) { // capture to the sides.\n\t\t\t\t\treturn [piece.position[0] + d[0], piece.position[1] + d[1]];\n\t\t\t\t}).forEach(function (p) {\n\t\t\t\t\tif (board.isValidCoord(p)) {\n\t\t\t\t\t\tvar square = board.square(p);\n\t\t\t\t\t\tif (square && square.player !== piece.player) {\n\t\t\t\t\t\t\tr.push(p);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (this.position[0] === (direction > 0 ? 1 : board.height - 2)) { // double forward at first rank.\n\t\t\t\t\tp = [this.position[0] + 2 * direction, this.position[1]];\n\t\t\t\t\tif (!board.square(p)) { // move forward\n\t\t\t\t\t\tr.push(p);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.position[0] === (direction < 0 ? 1 : board.height - 2)) { // Promotions at the last rank.\n\t\t\t\t\tvar promotions = ['Knight', 'Bishop', 'Rook', 'Queen'];\n\t\t\t\t\treturn iterable(r).map(function (p) {\n\t\t\t\t\t\treturn promotions.map(function (k) {\n\t\t\t\t\t\t\treturn ['promote', piece.position, p, k];\n\t\t\t\t\t\t});\n\t\t\t\t\t}).flatten();\n\t\t\t\t} else {\n\t\t\t\t\treturn iterable(r).map(function (p) {\n\t\t\t\t\t\treturn ['move', piece.position, p];\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t//canMove: TODO,\n\n\t\t\tnext: function next(game, board, move) {\n\t\t\t\tif (move[0] === 'move') {\n\t\t\t\t\treturn Piece.prototype.next.call(this, game, board, move);\n\t\t\t\t} else { // Promotion\n\t\t\t\t\treturn board.clone()\n\t\t\t\t\t\t.__place__(move[1])\n\t\t\t\t\t\t.__place__(move[2], new Chess.kinds[move[3]](this.player, move[2]));\n\t\t\t\t}\n\t\t\t},\n\n\t\t\ttoString: function toString() {\n\t\t\t\treturn this.player === \"White\" ? \"P\" : \"p\";\n\t\t\t}\n\t\t}), // declare Chess.kinds.Pawn\n\n\t\tKnight: declare(Piece, {\n\t\t\tname: 'Knight',\n\n\t\t\tDELTAS: [[+2,+1],[+1,+2],[+2,-1],[-1,+2],[-2,-1],[-1,-2],[-2,+1],[+1,-2]],\n\n\t\t\tmoves: function moves(game, board) {\n\t\t\t\tvar piece = this;\n\t\t\t\treturn iterable(this.DELTAS).map(function (d) {\n\t\t\t\t\treturn ['move', piece.position, [piece.position[0] + d[0], piece.position[1] + d[1]]];\n\t\t\t\t}, function (m) {\n\t\t\t\t\tif (board.isValidCoord(m[2])) {\n\t\t\t\t\t\tvar s = board.square(m[2]);\n\t\t\t\t\t\treturn !s || s.player !== piece.player;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t//canMove: TODO,\n\n\t\t\ttoString: function toString() {\n\t\t\t\treturn this.player === \"White\" ? \"N\" : \"n\";\n\t\t\t}\n\t\t}), // declare Chess.kinds.Knight\n\n\t\tBishop: declare(Piece, {\n\t\t\tname: 'Bishop',\n\n\t\t\tmoves: function moves(game, board) {\n\t\t\t\tvar piece = this;\n\t\t\t\treturn iterable(board.walks(this.position, Checkerboard.DIRECTIONS.DIAGONAL)).map(function (walk) {\n\t\t\t\t\tvar cont = true;\n\t\t\t\t\treturn walk.tail().takeWhile(function (p) {\n\t\t\t\t\t\tvar square = board.square(p),\n\t\t\t\t\t\t\tr = cont && (!square || square.player !== piece.player);\n\t\t\t\t\t\tcont = cont && !square;\n\t\t\t\t\t\treturn r;\n\t\t\t\t\t}).map(function (p) {\n\t\t\t\t\t\treturn ['move', piece.position, p];\n\t\t\t\t\t});\n\t\t\t\t}).flatten();\n\t\t\t},\n\n\t\t\t//canMove: TODO,\n\n\t\t\tnext: function (game, board, move) {\n\t\t\t\treturn board.clone()\n\t\t\t\t\t.__place__(move[1])\n\t\t\t\t\t.__place__(move[2], new this.constructor(this.player, move[2]));\n\t\t\t},\n\n\t\t\ttoString: function toString() {\n\t\t\t\treturn this.player === \"White\" ? \"B\" : \"b\";\n\t\t\t}\n\t\t}), // declare Chess.kinds.Bishop\n\n\t\tRook: declare(Piece, {\n\t\t\tname: 'Rook',\n\n\t\t\tmoves: function moves(game, board) {\n\t\t\t\tvar piece = this;\n\t\t\t\treturn iterable(board.walks(this.position, Checkerboard.DIRECTIONS.ORTHOGONAL)).map(function (walk) {\n\t\t\t\t\tvar cont = true;\n\t\t\t\t\treturn walk.tail().takeWhile(function (p) {\n\t\t\t\t\t\tvar square = board.square(p),\n\t\t\t\t\t\t\tr = cont && (!square || square.player !== piece.player);\n\t\t\t\t\t\tcont = cont && !square;\n\t\t\t\t\t\treturn r;\n\t\t\t\t\t}).map(function (p) {\n\t\t\t\t\t\treturn ['move', piece.position, p];\n\t\t\t\t\t});\n\t\t\t\t}).flatten();\n\t\t\t},\n\n\t\t\t//canMove: TODO,\n\n\t\t\ttoString: function toString() {\n\t\t\t\treturn this.player === \"White\" ? \"R\" : \"r\";\n\t\t\t}\n\t\t}), // declare Chess.kinds.Rook\n\n\t\tQueen: declare(Piece, {\n\t\t\tname: 'Queen',\n\n\t\t\tmoves: function moves(game, board) {\n\t\t\t\tvar piece = this;\n\t\t\t\treturn iterable(board.walks(this.position, Checkerboard.DIRECTIONS.EVERY)).map(function (walk) {\n\t\t\t\t\tvar cont = true;\n\t\t\t\t\treturn walk.tail().takeWhile(function (p) {\n\t\t\t\t\t\tvar square = board.square(p),\n\t\t\t\t\t\t\tr = cont && (!square || square.player !== piece.player);\n\t\t\t\t\t\tcont = cont && !square;\n\t\t\t\t\t\treturn r;\n\t\t\t\t\t}).map(function (p) {\n\t\t\t\t\t\treturn ['move', piece.position, p];\n\t\t\t\t\t});\n\t\t\t\t}).flatten();\n\t\t\t},\n\n\t\t\t//canMove: TODO,\n\n\t\t\ttoString: function toString() {\n\t\t\t\treturn this.player === \"White\" ? \"Q\" : \"q\";\n\t\t\t}\n\t\t}), // declare Chess.kinds.Queen\n\n\t\tKing: declare(Piece, { // TODO Castling.\n\t\t\tname: 'King',\n\n\t\t\tmoves: function moves(game, board) {\n\t\t\t\tvar piece = this;\n\t\t\t\treturn iterable(Checkerboard.DIRECTIONS.EVERY).map(function (d) {\n\t\t\t\t\treturn ['move', piece.position, [piece.position[0] + d[0], piece.position[1] + d[1]]];\n\t\t\t\t}, function (m) {\n\t\t\t\t\tif (board.isValidCoord(m[2])) {\n\t\t\t\t\t\tvar s = board.square(m[2]);\n\t\t\t\t\t\treturn !s || s.player !== piece.player;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\tcanMove: function canMove(game, board, pos) {\n\t\t\t\tif (board.isValidCoord(pos)\t&&\n\t\t\t\t\t\t(Math.abs(this.position[0] - pos[0]) === 1) !== (Math.abs(this.position[1] - pos[1]) === 1)\n\t\t\t\t\t) {\n\t\t\t\t\tvar sq = board.square(pos);\n\t\t\t\t\treturn !sq || sq.player !== this.player;\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\ttoString: function toString() {\n\t\t\t\treturn this.player === \"White\" ? \"K\" : \"k\";\n\t\t\t}\n\t\t}) // declare Chess.kinds.King\n\t},\n\n\t// ## Game methods #############################################################################\n\n\t/** A move always places a piece in an empty square, if and only if by doing so one or more\n\tlines of the opponent's pieces get enclosed between pieces of the active player.\n\t*/\n\tmoves: function moves() {\n\t\tif (!this.hasOwnProperty('__moves__')) {\n\t\t\tvar game = this,\n\t\t\t\tboard = this.board,\n\t\t\t\tactivePlayer = this.activePlayer(),\n\t\t\t\tking = this.pieces[activePlayer].King[0];\n\t\t\t\tthis.checkMoves = []; /*FIXME iterable(this.pieces[this.opponent()]).select(1).flatten().filter(function (p) {\n\t\t\t\t\treturn p.canMove(king.position);\n\t\t\t\t}).toArray();*/\n\t\t\tif (this.checkMoves.length < 1) { // Active player's king is not in check.\n\t\t\t\tthis.__moves__ = base.obj(activePlayer, iterable(this.pieces[activePlayer])\n\t\t\t\t\t.mapApply(function (kind, pieces) {\n\t\t\t\t\t\treturn pieces;\n\t\t\t\t\t}).flatten().map(function (p) {\n\t\t\t\t\t\treturn p.moves(game, board);\n\t\t\t\t\t}).flatten().toArray()\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthrow new Error('Do not know what to do when in check!');//FIXME\n\t\t\t}\n\t\t}\n\t\treturn this.__moves__;\n\t},\n\n\t/** TODO.\n\t*/\n\tnext: function next(moves, haps, update) {\n\t\t//FIXME WIP\n\t\traiseIf(haps, 'Haps are not required (given ', haps, ')!');\n\t\tvar activePlayer = this.activePlayer(),\n\t\t\tmove = moves[activePlayer],\n\t\t\tmovingPiece = this.board.square(move[1]);\n\t\t//console.log(this+\"\");//LOG\n\t\tvar args = {\n\t\t\tactivePlayer: this.opponent(),\n\t\t\tboard: movingPiece.next(this, this.board, move),\n\t\t\tcastling: this.castling,\n\t\t\tenPassant: null,\n\t\t\thalfMoves: this.halfMoves,\n\t\t\tfullMoves: this.fullMoves + (activePlayer === 'Black' ? 1 : 0)\n\t\t};\n\t\tif (update) {\n\t\t\tthis.constructor(args);\n\t\t\treturn this;\n\t\t} else {\n\t\t\treturn new this.constructor(args);\n\t\t}\n\t},\n\n\t/** TODO.\n\t*/\n\tresult: function result() {\n\t\t//FIXME\n\t\tif (this.moves()[this.activePlayer()]) {\n\t\t\treturn null;\n\t\t} else if (this.checkMoves.length > 0) { // Checkmate!\n\t\t\treturn this.defeat();\n\t\t} else { // Stalemate.\n\t\t\treturn this.draw();\n\t\t}\n\t},\n\n\t// ## Utility methods ##########################################################################\n\n\t/** The game state serialization uses [Forsyth–Edwards notation](http://en.wikipedia.org/wiki/Forsyth%E2%80%93Edwards_Notation).\n\t*/\n\t'static __SERMAT__': {\n\t\tidentifier: 'Chess',\n\t\tserializer: function serialize_Chess(obj) {\n\t\t\treturn [obj.toFEN()];\n\t\t},\n\t\tmaterializer: function materialize_Chess(obj, args) {\n\t\t\treturn args ? Chess.fromFEN(args[0]) : null;\n\t\t}\n\t},\n\n\t'dual coordFromString': function coordFromString(str) {\n\t\treturn [+str.charAt(1) + 1, str.charCodeAt(0) - 'a'.charCodeAt(0)];\n\t},\n\n\t'dual coordToString': function coordToString(coord) {\n\t\treturn String.fromCharCode('a'.charCodeAt(0) + coord[1]) + (coord[0] + 1);\n\t},\n\n\t/** The default string representation of Chess is the\n\t[Forsyth–Edwards notation](http://en.wikipedia.org/wiki/Forsyth%E2%80%93Edwards_Notation).\n\t*/\n\ttoString: function toString() {\n\t\treturn this.toFEN();\n\t},\n\n\ttoFEN: function toFEN() {\n\t\tvar board = this.board,\n\t\t\tresult = board.horizontals().map(function (hline) {\n\t\t\t\tvar lineText = '',\n\t\t\t\t\temptySquares = 0;\n\t\t\t\thline.forEach(function (coord) {\n\t\t\t\t\tvar p = board.square(coord);\n\t\t\t\t\tif (!p) {\n\t\t\t\t\t\temptySquares++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (emptySquares > 0) {\n\t\t\t\t\t\t\tlineText += emptySquares;\n\t\t\t\t\t\t\temptySquares = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlineText += p.toString();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (emptySquares > 0) {\n\t\t\t\t\tlineText += emptySquares;\n\t\t\t\t}\n\t\t\t\treturn lineText;\n\t\t\t}).join('/');\n\t\tresult += \" \"+ (this.activePlayer().charAt(0).toLowerCase());\n\t\tresult += \" \"+ this.castling;\n\t\tresult += \" \"+ (this.enPassant ? this.coordToString(this.enPassant) : \"-\");\n\t\tresult += \" \"+ this.halfMoves +\" \"+ this.fullMoves;\n\t\treturn result;\n\t},\n\n\t/** The `fromFEN` function parses a string in [Forsyth–Edwards notation](http://en.wikipedia.org/wiki/Forsyth%E2%80%93Edwards_Notation)\n\tand builds the corresponding game state.\n\t*/\n\t'static fromFEN': function fromFEN(str) {\n\t\tstr = str.trim();\n\t\tvar match = this.FEN_REGEXP.exec(str);\n\t\traiseIf(!match, \"Invalid FEN string '\", str, \"'!\");\n\t\treturn new this({\n\t\t\tboard: this.boardFromFEN(match[1]),\n\t\t\tactivePlayer: match[2] === 'w' ? 'White' : 'Black',\n\t\t\tcastling: match[3] === '-' ? \"\" : match[3],\n\t\t\tenPassant: match[4] === '-' ? null : this.coordFromString(match[4]),\n\t\t\thalfMoves: +match[5],\n\t\t\tfullMoves: +match[6]\n\t\t});\n\t},\n\n\t/** To parse a string in [Forsyth–Edwards notation](http://en.wikipedia.org/wiki/Forsyth%E2%80%93Edwards_Notation)\n\tthis is regular expression is used. Capturing groups are: board, active player, castling, en\n\tpassant, half move and full move. Spaces at beginning and end must be trimmed before matching.\n\t*/\n\t'static FEN_REGEXP':\n\t\t/^((?:[pnbrqkPNBRQK12345678]+\\/){7}[pnbrqkPNBRQK12345678]+)\\s+([wb])\\s+(-|[KQkq]+)\\s+(-|[a-h][1-8])\\s+(\\d+)\\s+(\\d+)$/,\n\n\t'dual boardFromFEN': function boardFromFEN(str) {\n\t\tvar rows = str.split('/'),\n\t\t\tkinds = {\n\t\t\t\t'p': this.kinds.Pawn,\n\t\t\t\t'n': this.kinds.Knight,\n\t\t\t\t'b': this.kinds.Bishop,\n\t\t\t\t'r': this.kinds.Rook,\n\t\t\t\t'q': this.kinds.Queen,\n\t\t\t\t'k': this.kinds.King\n\t\t\t},\n\t\t\tpieces = [];\n\t\trows.forEach(function (row, r) {\n\t\t\tvar c = 0;\n\t\t\titerable(row).forEach(function (sq) {\n\t\t\t\tif (!isNaN(sq)) {\n\t\t\t\t\tc += sq |0;\n\t\t\t\t} else {\n\t\t\t\t\tpieces.push(new kinds[sq.toLowerCase()](\n\t\t\t\t\t\tsq === sq.toLowerCase() ? 'Black' : 'White',\n\t\t\t\t\t\t[r, c]\n\t\t\t\t\t));\n\t\t\t\t\tc++;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\treturn new ludorum.utils.CheckerboardFromPieces(8, 8, pieces);\n\t},\n\n\t// ## Heuristics ###############################################################################\n\n\t/** `Chess.heuristics` is a bundle of helper functions to build heuristic evaluation functions\n\tfor this game.\n\t*/\n\t'static heuristics': {\n\t\t// TODO\n\t}\n}); // declare Othello.\n\n// ## Initial board ################################################################################\n\n/** The initial board of Chess has the first rank of the board with the following pieces for Whites:\nRook, Knight, Bishop, Queen, King, Bishop, Knight and Rook. The next rank has 8 Pawns. Blacks have a\nsymmetrical layout on their ranks.\n*/\nChess.initialBoard = Chess.prototype.initialBoard =\n\tChess.boardFromFEN('rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR');\n\n/** Adding Mancala to `ludorum.games`.\n*/\nludorum.games.Chess = Chess;\n\n/** Sermat serialization.\n*/\nChess.__SERMAT__.identifier = exports.__package__ +'.'+ Chess.__SERMAT__.identifier;\nexports.__SERMAT__.include.push(Chess);\nSermat.include(exports);\n","// See __prologue__.js\n\treturn exports;\n}\n"]}